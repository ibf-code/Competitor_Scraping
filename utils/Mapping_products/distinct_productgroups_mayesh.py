from bs4 import BeautifulSoup
import csv
import pandas as pd


# raw html from the productgroup section
data =  """ <ul data-v-efd497d0="" class="filters"><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="1181">Achillea Ptarmica</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="479">Agapanthus</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="490">Alstroemeria</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="491">Amaranthus</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="495">Anemone</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="496">Anemone Mistral</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="499">Aralia</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="505">Aspidistra</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="509">Aster</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="511">Astrantia</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="512">Atriplex</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="526">Bells of Ireland</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="535">Bird of Paradise</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="545">Bouquet</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="549">Bromeliad</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="1091">Bupleurum</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="555">Calla Lily</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="1192">Calla Lily Mini</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="559">Campanula</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="562">Carnation</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="582">Chrysanthemum Disbud</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="590">Cocculus</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="593">Commodore</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="607">Craspedia Billy Balls</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="608">Cremons</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="619">Dahlia</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="621">Delphinium</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="627">Dianthus</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="635">Dusty Miller</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="642">Eryngium</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="643">Eucalyptus</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="648">Eupatorium</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="666">Fuji</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="668">Galax</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="1051">Garland</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="678">Gerbera</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="691">Grass</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="692">Green Mist</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="695">Gypsophila</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="704">Helleborus</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="710">Honey Bracelet</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="717">Hydrangea</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="719">Hypericum</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="738">Kale</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="739">Kangaroo Paw</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="745">Larkspur</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="748">Leather</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="754">Lepidium</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="756">Leucadendron</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="759">Leucospermum (Pincushion)</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="762">Liatris</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="767">Lily Asiatic</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="768">Lily Grass</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="771">Lily Oriental</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="775">Limonium</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="780">Lisianthus</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="789">Lysimachia</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="800">Ming Fern</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="802">Mini Carnation</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="811">Moss</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="813">Mum</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="815">Myersii (Foxtail Fern)</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="818">Nagi</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="831">Ornithogalum</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="835">Palm Leaf</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="838">Papyrus</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="851">Phlox</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="857">Pistachio Foliage</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="858">Pittosporum</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="859">Plant</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="861">Plumosa</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="862">Pod</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="870">Pompon</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="866">Pompon Button</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="871">Pompon Cushion</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="867">Pompon Daisy</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="876">Poppy</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="884">Protea</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="889">Ranunculus</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="890">Ranunculus Butterfly</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="898">Riceflower</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="900">Rose</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="556">Rose Garden</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="910">Ruscus</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="921">Scabiosa</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="934">Snapdragon</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="938">Solidago</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="946">Spray Rose</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="947">Spray Rose Garden</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="949">Springerii</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="953">Statice</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="957">Stock</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="958">Strawflower</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="961">Sunflower</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="963">Sweet Pea</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="964">Sweet Pea Japan</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="965">Sweet William</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="966">Sword Fern</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="968">Thlaspi (Penny Cress)</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="974">Trachelium</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="975">Tree Fern</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="991">Tweedia</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="998">Veronica</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="1002">Viburnum Foliage</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="1006">Wax Flower</li><li data-v-efd497d0="" class=""><input data-v-efd497d0="" type="checkbox" value="1014">Yarrow</li><!----></ul> """

# Parse the HTML data
soup = BeautifulSoup(data, 'html.parser')

# Extract product groups
product_groups = []
for list_item in soup.find_all('li'):
    input_element = list_item.find('input')
    if input_element:
        value = input_element['value']
        product_name = list_item.get_text()
        product_groups.append({
            'Product_group_key': value,
            'Product_group_name': product_name
        })
df = pd.DataFrame(product_groups) 
df.to_csv('mapping/mayesh_productgroups_raw.csv', index=False)
print(df.head())


